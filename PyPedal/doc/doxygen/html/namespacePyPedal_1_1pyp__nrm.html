<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PyPedal: Package PyPedal.pyp_nrm</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="namespacemembers.html"><span>Package&nbsp;Functions</span></a></li>
  </ul></div>
<div class="nav">
<b>PyPedal</b>.<a class="el" href="namespacePyPedal_1_1pyp__nrm.html">pyp_nrm</a></div>
<h1>Package PyPedal.pyp_nrm</h1>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#160c730a5f8ed4809c427645d3331262">a_matrix</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#160c730a5f8ed4809c427645d3331262">a_matrix()</a> is used to form a numerator relationship matrix from a pedigree.  <a href="#160c730a5f8ed4809c427645d3331262"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Form a numerator relationship matrix from a pedigree.  <a href="#d86974b6cb70f5165d7f9b41b68b613e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#314c945257fa3c101f6c47c1d4fb4079">fast_a_matrix_r</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Form a relationship matrix from a pedigree.  <a href="#314c945257fa3c101f6c47c1d4fb4079"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#925b0d16b9dcbd72291dbc2c4209e428">inbreeding</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#925b0d16b9dcbd72291dbc2c4209e428">inbreeding()</a> is a proxy function used to dispatch pedigrees to the appropriate function for computing CoI.  <a href="#925b0d16b9dcbd72291dbc2c4209e428"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#577fd15845cca08988029a7ccf7f68e4">inbreeding_vanraden</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#577fd15845cca08988029a7ccf7f68e4">inbreeding_vanraden()</a> uses VanRaden's (1992) method for computing coefficients of inbreeding in a large pedigree.  <a href="#577fd15845cca08988029a7ccf7f68e4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#c2e0cc42e37f47162f7844645ebf21e1">recurse_pedigree</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#c2e0cc42e37f47162f7844645ebf21e1">recurse_pedigree()</a> performs the recursion needed to build the subpedigrees used by <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#577fd15845cca08988029a7ccf7f68e4">inbreeding_vanraden()</a>.  <a href="#c2e0cc42e37f47162f7844645ebf21e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#9fe4e7e546ef28461188a080d971cdf7">recurse_pedigree_n</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#9fe4e7e546ef28461188a080d971cdf7">recurse_pedigree_n()</a> recurses to build a pedigree of depth n.  <a href="#9fe4e7e546ef28461188a080d971cdf7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#71cc351a78e2a8f9b528a5e696efecc2">recurse_pedigree_onesided</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#71cc351a78e2a8f9b528a5e696efecc2">recurse_pedigree_onesided()</a> recurses to build a subpedigree from either the sire or dam side of a pedigree.  <a href="#71cc351a78e2a8f9b528a5e696efecc2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#0497f483c9c840213e97cff287417c71">recurse_pedigree_idonly</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#0497f483c9c840213e97cff287417c71">recurse_pedigree_idonly()</a> performs the recursion needed to build subpedigrees.  <a href="#0497f483c9c840213e97cff287417c71"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#88b1e0971e11743e8b521ef227e29e6f">recurse_pedigree_idonly_side</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#88b1e0971e11743e8b521ef227e29e6f">recurse_pedigree_idonly_side()</a> performs the recursion needed to build a subpedigree containing only animal IDs for either all sires or all dams.  <a href="#88b1e0971e11743e8b521ef227e29e6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#ca22371da820f4c44272c0c49813bda2">inbreeding_tabular</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#ca22371da820f4c44272c0c49813bda2">inbreeding_tabular()</a> computes CoI using the tabular method by calling <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix()</a> to form the NRM directly.  <a href="#ca22371da820f4c44272c0c49813bda2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#1f381e4601f9cbfec699bc2b293fc5eb">a_decompose</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Form the decomposed form of A, TDT', directly from a pedigree (after Henderson, 1976; Thompson, 1977; Mrode, 1996).  <a href="#1f381e4601f9cbfec699bc2b293fc5eb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#43df241a5d555995a4bc7d3fd2ff01bf">form_d_nof</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Form the diagonal matrix, D, used in decomposing A and forming the direct inverse of A.  <a href="#43df241a5d555995a4bc7d3fd2ff01bf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#9c6e5cd761d3de4d0501e0fa9c8b2977">a_inverse_dnf</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Form the inverse of A directly using the method of Henderson (1976) which does not account for inbreeding.  <a href="#9c6e5cd761d3de4d0501e0fa9c8b2977"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#4bb868be035fbfd5953a580b441cd566">a_inverse_df</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Directly form the inverse of A from the pedigree file - accounts for inbreeding - using the method of Quaas (1976).  <a href="#4bb868be035fbfd5953a580b441cd566"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#271ba7166235340580cfe58aa31c887d">partial_inbreeding</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#271ba7166235340580cfe58aa31c887d">partial_inbreeding()</a> computes coefficients of partial inbreeding, which is the probability that an individual, i, is IDB at a locus and that the alleles were derived from ancestor j.  <a href="#271ba7166235340580cfe58aa31c887d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#aeaadca15ddc3430d7b46cde3470e808">fast_partial_a_matrix</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="namespacePyPedal_1_1pyp__nrm.html#aeaadca15ddc3430d7b46cde3470e808">fast_partial_a_matrix()</a> calculates a partial kinship matrix for a given founder in a pedigree, and returns a dictionary of partial inbreeding coefficients between that founder and and descendants (non-founders) in the pedigree.  <a href="#aeaadca15ddc3430d7b46cde3470e808"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="160c730a5f8ed4809c427645d3331262"></a><!-- doxytag: member="PyPedal::pyp_nrm::a_matrix" ref="160c730a5f8ed4809c427645d3331262" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.a_matrix           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>save</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#160c730a5f8ed4809c427645d3331262">a_matrix()</a> is used to form a numerator relationship matrix from a pedigree. 
<p>
DEPRECATED. use <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix()</a> instead. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>save</em>&nbsp;</td><td>Flag to indicate whether or not the relationship matrix is written to a file. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>NRM as a NumPy matrix.<div class="fragment"><pre class="fragment">Form a numerator relationship matrix from a pedigree.  DEPRECATED.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00054">54</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="d86974b6cb70f5165d7f9b41b68b613e"></a><!-- doxytag: member="PyPedal::pyp_nrm::fast_a_matrix" ref="d86974b6cb70f5165d7f9b41b68b613e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.fast_a_matrix           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedigree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedopts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>save</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>method</em> = <code>'dense'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>debug</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>fill</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Form a numerator relationship matrix from a pedigree. 
<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix()</a> is a hacked version of <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#160c730a5f8ed4809c427645d3331262">a_matrix()</a> modified to try and improve performance. Lists of animal, sire, and dam IDs are formed and accessed rather than myped as it is much faster to access a member of a simple list rather than an attribute of an object in a list. Further note that only the diagonal and upper off-diagonal of A are populated. This is done to save n(n+1) / 2 matrix writes. For a 1000-element array, this saves 500,500 writes. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedigree</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pedopts</em>&nbsp;</td><td>PyPedal options. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>save</em>&nbsp;</td><td>Flag to indicate whether or not the relationship matrix is written to a file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>Use dense or sparse matrix storage. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>debug</em>&nbsp;</td><td>Print NRM for debugging </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fill</em>&nbsp;</td><td>Fill both the upper and lower off-diagonals when 1, only the upper otherwise. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>NRM as Numarray matrix.<div class="fragment"><pre class="fragment">Form a numerator relationship matrix from a pedigree.  fast_a_matrix() is a hacked
version of a_matrix() modified to try and improve performance.  Lists of animal,
sire, and dam IDs are formed and accessed rather than myped as it is much faster to
access a member of a simple list rather than an attribute of an object in a
list.  Further note that only the diagonal and upper off-diagonal of A are
populated.  This is done to save n(n+1) / 2 matrix writes.  For a 1000-element
array, this saves 500,500 writes.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00138">138</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="314c945257fa3c101f6c47c1d4fb4079"></a><!-- doxytag: member="PyPedal::pyp_nrm::fast_a_matrix_r" ref="314c945257fa3c101f6c47c1d4fb4079" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.fast_a_matrix_r           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedigree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedopts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>save</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>method</em> = <code>'dense'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Form a relationship matrix from a pedigree. 
<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#314c945257fa3c101f6c47c1d4fb4079">fast_a_matrix_r()</a> differs from <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix()</a> in that the coefficients of relationship are corrected for the inbreeding of the parents. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedigree</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pedopts</em>&nbsp;</td><td>PyPedal options. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>save</em>&nbsp;</td><td>Flag to indicate whether or not the relationship matrix is written to a file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>Use dense or sparse matrix storage. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>relationship as Numarray matrix.<div class="fragment"><pre class="fragment">Form a relationship matrix from a pedigree.  fast_a_matrix_r() differs from
fast_a_matrix() in that the coefficients of relationship are corrected for the
inbreeding of the parents.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00287">287</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="925b0d16b9dcbd72291dbc2c4209e428"></a><!-- doxytag: member="PyPedal::pyp_nrm::inbreeding" ref="925b0d16b9dcbd72291dbc2c4209e428" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.inbreeding           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>method</em> = <code>'tabular'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>gens</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>rels</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>output</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#925b0d16b9dcbd72291dbc2c4209e428">inbreeding()</a> is a proxy function used to dispatch pedigrees to the appropriate function for computing CoI. 
<p>
By default, small pedigrees &lt; 10,000 animals) are processed with the tabular method directly. For larger pedigrees, or if requested, the recursive method of VanRaden (1992) is used. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>Keyword indicating which method of computing CoI should be used (tabular|vanraden). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gens</em>&nbsp;</td><td>The number of generations from the pedigree to be used for calculating CoI. By default, gens=0, which uses the complete pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rels</em>&nbsp;</td><td>Flag indicating whether or not summary statistics should be computed for coefficients of relationship. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>Flag indicating whether or not output files should be written. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>dictionary of CoI keyed to renumbered animal IDs.<div class="fragment"><pre class="fragment">inbreeding() is a proxy function used to dispatch pedigrees to the appropriate
function for computing CoI.  By default, small pedigrees &lt; 10,000 animals) are
processed with the tabular method directly.  For larger pedigrees, or if requested,
the recursive method of VanRaden (1992) is used.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00429">429</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="577fd15845cca08988029a7ccf7f68e4"></a><!-- doxytag: member="PyPedal::pyp_nrm::inbreeding_vanraden" ref="577fd15845cca08988029a7ccf7f68e4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.inbreeding_vanraden           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>cleanmaps</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>gens</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>rels</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#577fd15845cca08988029a7ccf7f68e4">inbreeding_vanraden()</a> uses VanRaden's (1992) method for computing coefficients of inbreeding in a large pedigree. 
<p>
The method works as follows: 1. Take a large pedigree and order it from youngest animal to oldest (n, n-1, ..., 1); 2. Recurse through the pedigree to find all of the ancestors of that animal n; 3. Reorder and renumber that "subpedigree"; 4. Compute coefficients of inbreeding for that "subpedigree" using the tabular method (Emik and Terrill, 1949); 5. Put the coefficients of inbreeding in a dictionary; 6. Repeat 2 - 5 for animals n-1 through 1; the process is slowest for the early pedigrees and fastest for the later pedigrees. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cleanmaps</em>&nbsp;</td><td>Flag to denote whether or not subpedigree ID maps should be deleted after they are used (0|1). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gens</em>&nbsp;</td><td>The number of generations from the pedigree to be used for calculating CoI. By default, gens=0, which uses the complete pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rels</em>&nbsp;</td><td>Flag indicating whether or not summary statistics should be computed for coefficients of relationship. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>dictionary of CoI keyed to renumbered animal IDs<div class="fragment"><pre class="fragment">inbreeding_vanraden() uses VanRaden's (1992) method for computing coefficients of
inbreeding in a large pedigree.  The method works as follows:
1.  Take a large pedigree and order it from youngest animal to oldest (n, n-1, ...,
    1);
2.  Recurse through the pedigree to find all of the ancestors of that animal n;
3.  Reorder and renumber that "subpedigree";
4.  Compute coefficients of inbreeding for that "subpedigree" using the tabular
    method (Emik and Terrill, 1949);
5.  Put the coefficients of inbreeding in a dictionary;
6.  Repeat 2 - 5 for animals n-1 through 1; the process is slowest for the early
    pedigrees and fastest for the later pedigrees.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00649">649</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="c2e0cc42e37f47162f7844645ebf21e1"></a><!-- doxytag: member="PyPedal::pyp_nrm::recurse_pedigree" ref="c2e0cc42e37f47162f7844645ebf21e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.recurse_pedigree           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>anid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>_ped</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#c2e0cc42e37f47162f7844645ebf21e1">recurse_pedigree()</a> performs the recursion needed to build the subpedigrees used by <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#577fd15845cca08988029a7ccf7f68e4">inbreeding_vanraden()</a>. 
<p>
For the animal with animalID anid <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#c2e0cc42e37f47162f7844645ebf21e1">recurse_pedigree()</a> will recurse through the pedigree myped and add references to the relatives of anid to the temporary pedigree, _ped. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>anid</em>&nbsp;</td><td>The ID of the animal whose relatives are being located. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_ped</em>&nbsp;</td><td>A temporary PyPedal pedigree that stores references to relatives of anid. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>list of references to the relatives of anid contained in myped.<div class="fragment"><pre class="fragment">recurse_pedigree() performs the recursion needed to build the subpedigrees used by
inbreeding_vanraden().  For the animal with animalID anid recurse_pedigree() will
recurse through the pedigree myped and add references to the relatives of anid to
the temporary pedigree, _ped.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00885">885</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="9fe4e7e546ef28461188a080d971cdf7"></a><!-- doxytag: member="PyPedal::pyp_nrm::recurse_pedigree_n" ref="9fe4e7e546ef28461188a080d971cdf7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.recurse_pedigree_n           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>anid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>_ped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>depth</em> = <code>3</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#9fe4e7e546ef28461188a080d971cdf7">recurse_pedigree_n()</a> recurses to build a pedigree of depth n. 
<p>
A depth less than 1 returns the animal whose relatives were to be identified. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>anid</em>&nbsp;</td><td>The ID of the animal whose relatives are being located. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_ped</em>&nbsp;</td><td>A temporary PyPedal pedigree that stores references to relatives of anid. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>depth</em>&nbsp;</td><td>The depth of the pedigree to return. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>list of references to the relatives of anid contained in myped.<div class="fragment"><pre class="fragment">recurse_pedigree_n() recurses to build a pedigree of depth n.  A depth
less than 1 returns the animal whose relatives were to be identified.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00915">915</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="71cc351a78e2a8f9b528a5e696efecc2"></a><!-- doxytag: member="PyPedal::pyp_nrm::recurse_pedigree_onesided" ref="71cc351a78e2a8f9b528a5e696efecc2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.recurse_pedigree_onesided           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>anid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>_ped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>side</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#71cc351a78e2a8f9b528a5e696efecc2">recurse_pedigree_onesided()</a> recurses to build a subpedigree from either the sire or dam side of a pedigree. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>side</em>&nbsp;</td><td>The side to build: 's' for sire and 'd' for dam. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>anid</em>&nbsp;</td><td>The ID of the animal whose relatives are being located. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_ped</em>&nbsp;</td><td>A temporary PyPedal pedigree that stores references to relatives of anid. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>list of references to the relatives of anid contained in myped.<div class="fragment"><pre class="fragment">recurse_pedigree_onesided() recurses to build a subpedigree from either the sire
or dam side of a pedigree.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00944">944</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="0497f483c9c840213e97cff287417c71"></a><!-- doxytag: member="PyPedal::pyp_nrm::recurse_pedigree_idonly" ref="0497f483c9c840213e97cff287417c71" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.recurse_pedigree_idonly           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>anid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>_ped</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#0497f483c9c840213e97cff287417c71">recurse_pedigree_idonly()</a> performs the recursion needed to build subpedigrees. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>anid</em>&nbsp;</td><td>The ID of the animal whose relatives are being located. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_ped</em>&nbsp;</td><td>A PyPedal list that stores the animalIDs of relatives of anid. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>list of animalIDs of the relatives of anid contained in myped.<div class="fragment"><pre class="fragment">recurse_pedigree_idonly() performs the recursion needed to build subpedigrees.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l00972">972</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="88b1e0971e11743e8b521ef227e29e6f"></a><!-- doxytag: member="PyPedal::pyp_nrm::recurse_pedigree_idonly_side" ref="88b1e0971e11743e8b521ef227e29e6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.recurse_pedigree_idonly_side           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>anid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>_ped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>side</em> = <code>'s'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#88b1e0971e11743e8b521ef227e29e6f">recurse_pedigree_idonly_side()</a> performs the recursion needed to build a subpedigree containing only animal IDs for either all sires or all dams. 
<p>
That is, a pedigree would go sire-paternal grandsire-paternal great-grandsire, etc. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>anid</em>&nbsp;</td><td>The ID of the animal whose relatives are being located. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_ped</em>&nbsp;</td><td>A PyPedal list that stores the animalIDs of relatives of anid. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>side</em>&nbsp;</td><td>The side of the pedigree to follow ('s'|'d'). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>list of animalIDs of the relatives of anid contained in myped.<div class="fragment"><pre class="fragment">recurse_pedigree_idonly_side() performs the recursion needed to build
a subpedigree containing only animal IDs for either all sires or all
dams.  That is, a pedigree would go sire-paternal grandsire-paternal
great-grandsire, etc.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01002">1002</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="ca22371da820f4c44272c0c49813bda2"></a><!-- doxytag: member="PyPedal::pyp_nrm::inbreeding_tabular" ref="ca22371da820f4c44272c0c49813bda2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.inbreeding_tabular           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>gens</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>rels</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#ca22371da820f4c44272c0c49813bda2">inbreeding_tabular()</a> computes CoI using the tabular method by calling <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#d86974b6cb70f5165d7f9b41b68b613e">fast_a_matrix()</a> to form the NRM directly. 
<p>
In order for this routine to return successfully requires that you are able to allocate a matrix of floats of dimension len(myped)**2. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gens</em>&nbsp;</td><td>The number of generations from the pedigree to be used for calculating CoI. By default, gens=0, which uses the complete pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rels</em>&nbsp;</td><td>Flag indicating whether or not summary statistics should be computed for coefficients of relationship. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>dictionary of CoI keyed to renumbered animal IDs<div class="fragment"><pre class="fragment">inbreeding_tabular() computes CoI using the tabular method by calling
fast_a_matrix() to form the NRM directly.  In order for this routine
to return successfully requires that you are able to allocate a matrix
of floats of dimension len(myped)**2.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01037">1037</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="1f381e4601f9cbfec699bc2b293fc5eb"></a><!-- doxytag: member="PyPedal::pyp_nrm::a_decompose" ref="1f381e4601f9cbfec699bc2b293fc5eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.a_decompose           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Form the decomposed form of A, TDT', directly from a pedigree (after Henderson, 1976; Thompson, 1977; Mrode, 1996). 
<p>
Return D, a diagonal matrix, and T, a lower triagular matrix such that A = TDT'. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>diagonal matrix, D, and a lower triangular matrix, T.<div class="fragment"><pre class="fragment">Form the decomposed form of A, TDT', directly from a pedigree (after
Henderson, 1976; Thompson, 1977; Mrode, 1996).  Return D, a diagonal
matrix, and T, a lower triagular matrix such that A = TDT'.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01122">1122</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="43df241a5d555995a4bc7d3fd2ff01bf"></a><!-- doxytag: member="PyPedal::pyp_nrm::form_d_nof" ref="43df241a5d555995a4bc7d3fd2ff01bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.form_d_nof           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Form the diagonal matrix, D, used in decomposing A and forming the direct inverse of A. 
<p>
This function does not write output to a file - if you need D in a file, use the <a class="el" href="namespacePyPedal_1_1pyp__nrm.html#1f381e4601f9cbfec699bc2b293fc5eb">a_decompose()</a> function. form_d() is a convenience function used by other functions. Note that inbreeding is not considered in the formation of D. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>diagonal matrix, D.<div class="fragment"><pre class="fragment">Form the diagonal matrix, D, used in decomposing A and forming the direct
inverse of A.  This function does not write output to a file - if you need D in
a file, use the a_decompose()  function.  form_d() is a convenience function
used by other functions.  Note that inbreeding is not considered in the
formation of D.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01226">1226</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="9c6e5cd761d3de4d0501e0fa9c8b2977"></a><!-- doxytag: member="PyPedal::pyp_nrm::a_inverse_dnf" ref="9c6e5cd761d3de4d0501e0fa9c8b2977" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.a_inverse_dnf           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>filetag</em> = <code>'_a_inverse_dnf_'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Form the inverse of A directly using the method of Henderson (1976) which does not account for inbreeding. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filetag</em>&nbsp;</td><td>Prefix added to output file names. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>inverse of the NRM, A, not accounting for inbreeding.<div class="fragment"><pre class="fragment">Form the inverse of A directly using the method of Henderson (1976) which
does not account for inbreeding.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01284">1284</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="4bb868be035fbfd5953a580b441cd566"></a><!-- doxytag: member="PyPedal::pyp_nrm::a_inverse_df" ref="4bb868be035fbfd5953a580b441cd566" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.a_inverse_df           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Directly form the inverse of A from the pedigree file - accounts for inbreeding - using the method of Quaas (1976). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>inverse of the NRM, A, accounting for inbreeding.<div class="fragment"><pre class="fragment">Directly form the inverse of A from the pedigree file - accounts for
inbreeding - using the method of Quaas (1976).
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01372">1372</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="271ba7166235340580cfe58aa31c887d"></a><!-- doxytag: member="PyPedal::pyp_nrm::partial_inbreeding" ref="271ba7166235340580cfe58aa31c887d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.partial_inbreeding           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>animals</em> = <code>[]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>gens</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>rels</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>cleanmaps</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#271ba7166235340580cfe58aa31c887d">partial_inbreeding()</a> computes coefficients of partial inbreeding, which is the probability that an individual, i, is IDB at a locus and that the alleles were derived from ancestor j. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedobj</em>&nbsp;</td><td>A PyPedal pedigree object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>animals</em>&nbsp;</td><td>An empty list of renumbered animal IDs to process (do all when list empty). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gens</em>&nbsp;</td><td>The number of generations from the pedigree to be used for calculating CoI. By default, gens=0, which uses the complete pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rels</em>&nbsp;</td><td>Flag indicating whether or not summary statistics should be computed for coefficients of relationship. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cleanmaps</em>&nbsp;</td><td>Flag to denote whether or not subpedigree ID maps should be deleted after they are used (0|1). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>dictionary of partial CoI keyed to renumbered animal IDs.<div class="fragment"><pre class="fragment">partial_inbreeding() computes coefficients of partial inbreeding,
which is the probability that an individual, i, is IDB at a locus
and that the alleles were derived from ancestor j.
Input: A PyPedal pedigree object.
Output: A dictionary of partial CoI keyed to renumbered animal IDs.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01493">1493</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<a class="anchor" name="aeaadca15ddc3430d7b46cde3470e808"></a><!-- doxytag: member="PyPedal::pyp_nrm::fast_partial_a_matrix" ref="aeaadca15ddc3430d7b46cde3470e808" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def PyPedal.pyp_nrm.fast_partial_a_matrix           </td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedigree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>founder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>founderlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>pedopts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>method</em> = <code>'dense'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>debug</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="namespacePyPedal_1_1pyp__nrm.html#aeaadca15ddc3430d7b46cde3470e808">fast_partial_a_matrix()</a> calculates a partial kinship matrix for a given founder in a pedigree, and returns a dictionary of partial inbreeding coefficients between that founder and and descendants (non-founders) in the pedigree. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pedigree</em>&nbsp;</td><td>A PyPedal pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>founder</em>&nbsp;</td><td>Founder of interest. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>founderlist</em>&nbsp;</td><td>List of founders in the pedigree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pedopts</em>&nbsp;</td><td>PyPedal options. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>method</em>&nbsp;</td><td>Use dense or sparse matrix storage. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>debug</em>&nbsp;</td><td>Print NRM for debugging </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>NRM as Numarray matrix.<div class="fragment"><pre class="fragment">fast_partial_a_matrix() calculates a partial kinship matrix for a given
founder in a pedigree, and returns a dictionary of partial inbreeding
coefficients between that founder and and descendants (non-founders) in
the pedigree.
</pre></div> </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pyp__nrm_8py-source.html#l01648">1648</a> of file <a class="el" href="pyp__nrm_8py-source.html">pyp_nrm.py</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue Sep 28 14:09:58 2010 for PyPedal by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
