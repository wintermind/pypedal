<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=us-ascii' />
<title>The pyp_utils Module</title>
</head>
<body>
<h1>The pyp_utils Module</h1>
<p>pyp_utils contains a set of procedures for creating and operating on PyPedal pedigrees.
This includes routines for reordering and renumbering pedigrees, as well as for modifying
pedigrees.</p>
<h2>Module Contents</h2>
<dl>
<dt><a id='pyp_utils.assign_offspring-function' name='pyp_utils.assign_offspring-function'><b>assign_offspring(pedobj)</b></a> &rArr; integer [<a href='#pyp_utils.assign_offspring-function'>#</a>]</dt>
<dd>
<p>assign_offspring() assigns offspring to their parent(s)'s unknown sex offspring list (well, dictionary).</p>
<dl>
<dt><i>myped</i></dt>
<dd>
An instance of a NewPedigree object.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.assign_sexes-function' name='pyp_utils.assign_sexes-function'><b>assign_sexes(pedobj)</b></a> &rArr; integer [<a href='#pyp_utils.assign_sexes-function'>#</a>]</dt>
<dd>
<p>assign_sexes() assigns a sex to every animal in the pedigree using sire and daughter lists for improved accuracy.</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
A renumbered and reordered PyPedal pedigree object.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.delete_id_map-function' name='pyp_utils.delete_id_map-function'><b>delete_id_map(filetag='_renumbered_')</b></a> &rArr; integer [<a href='#pyp_utils.delete_id_map-function'>#</a>]</dt>
<dd>
<p>delete_id_map() checks to see if an ID map for the given filetag exists.  If the file exists, it is
deleted.</p>
<dl>
<dt><i>filetag</i></dt>
<dd>
A descriptor prepended to output file names that is used to determine name of the file to delete.</dd>
<dt>Returns:</dt>
<dd>
A flag indicating whether or not the file was successfully deleted (0|1)</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.fast_reorder-function' name='pyp_utils.fast_reorder-function'><b>fast_reorder(myped, filetag='_new_reordered_', io='no', debug=0)</b></a> &rArr; list [<a href='#pyp_utils.fast_reorder-function'>#</a>]</dt>
<dd>
<p>fast_reorder() renumbers a pedigree such that parents precede their offspring in
the pedigree.  In order to minimize overhead as much as is reasonably possible,
a list of animal IDs that have already been seen is kept.  Whenever a parent
that is not in the seen list is encountered, the offspring of that parent is
moved to the end of the pedigree.  This should ensure that the pedigree is
properly sorted such that all parents precede their offspring.  myped is
reordered in place.  fast_reorder() uses dictionaries to renumber the pedigree
based on paddedIDs.</p>
<dl>
<dt><i>myped</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>filetag</i></dt>
<dd>
A descriptor prepended to output file names.</dd>
<dt><i>io</i></dt>
<dd>
Indicates whether or not to write the reordered pedigree to a file (yes|no).</dd>
<dt><i>debug</i></dt>
<dd>
Flag to indicate whether or not debugging messages are written to STDOUT.</dd>
<dt>Returns:</dt>
<dd>
A reordered PyPedal pedigree.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.load_id_map-function' name='pyp_utils.load_id_map-function'><b>load_id_map(filetag='_renumbered_')</b></a> &rArr; dictionary [<a href='#pyp_utils.load_id_map-function'>#</a>]</dt>
<dd>
<p>load_id_map() reads an ID map from the file generated by pyp_utils/renumber()
into a dictionary.  There is a VERY similar function, pyp_io/id_map_from_file(), that
is deprecated because it is much more fragile that this procedure.</p>
<dl>
<dt><i>filetag</i></dt>
<dd>
A descriptor prepended to output file names that is used to determine the input file name.</dd>
<dt>Returns:</dt>
<dd>
A dictionary whose keys are renumbered IDs and whose values are original IDs or an empty dictionary (on failure).</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.pedigree_range-function' name='pyp_utils.pedigree_range-function'><b>pedigree_range(pedobj, n)</b></a> &rArr; list [<a href='#pyp_utils.pedigree_range-function'>#</a>]</dt>
<dd>
<p>pedigree_range() takes a renumbered pedigree and removes all individuals
with a renumbered ID &gt; n.  The reduced pedigree is returned.  Assumes that
the input pedigree is sorted on animal key in ascending order.</p>
<dl>
<dt><i>myped</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>n</i></dt>
<dd>
A renumbered animalID.</dd>
<dt>Returns:</dt>
<dd>
A pedigree containing only animals born in the given birthyear of an ampty list (on failure).</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.pyp_datestamp-function' name='pyp_utils.pyp_datestamp-function'><b>pyp_datestamp()</b></a> &rArr; string [<a href='#pyp_utils.pyp_datestamp-function'>#</a>]</dt>
<dd>
<p>pyp_datestamp() returns a datestamp, as a string, of the format
YYYYMMDDHHMMSS.</p>
<dl>
<dt><i>None</i></dt>
<dd>
</dd>
<dt>Returns:</dt>
<dd>
A 14-character string containing the datestamp.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.pyp_nice_time-function' name='pyp_utils.pyp_nice_time-function'><b>pyp_nice_time()</b></a> &rArr; string [<a href='#pyp_utils.pyp_nice_time-function'>#</a>]</dt>
<dd>
<p>pyp_nice_time() returns the current date and time formatted as, e.g.,
Wed Mar 30 10:26:31 2005.</p>
<dl>
<dt><i>None</i></dt>
<dd>
</dd>
<dt>Returns:</dt>
<dd>
A string containing the formatted date and time.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.renumber-function' name='pyp_utils.renumber-function'><b>renumber(myped, filetag='_renumbered_', io='no', outformat='0', debug=0, returnmap=0, missingparent=0, animaltype='new')</b></a> &rArr; list [<a href='#pyp_utils.renumber-function'>#</a>]</dt>
<dd>
<p>renumber() takes a pedigree as input and renumbers it such that the oldest
animal in the pedigree has an ID of '1' and the n-th animal has an ID of 'n'.  If the
pedigree is not ordered from oldest to youngest such that all offspring precede their
offspring, the pedigree will be reordered.  The renumbered pedigree is written to disc in
'asd' format and a map file that associates sequential IDs with original IDs is also
written.</p>
<dl>
<dt><i>myped</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>filetag</i></dt>
<dd>
A descriptor prepended to output file names.</dd>
<dt><i>io</i></dt>
<dd>
Indicates whether or not to write the renumbered pedigree to a file (yes|no).</dd>
<dt><i>outformat</i></dt>
<dd>
Flag to indicate whether or not to write an asd pedigree (0) or a full pedigree (1).</dd>
<dt><i>returnmap</i></dt>
<dd>
Indicates whether or not an ID map, as well as the renumbered pedigree, should be returned.  If nonzero, suppresses writing of ID maps to disc.</dd>
<dt><i>debug</i></dt>
<dd>
Flag to indicate whether or not progress messages are written to stdout.</dd>
<dt><i>missingparent</i></dt>
<dd>
Indicates the value used to indicate a missing parent.</dd>
<dt><i>animaltype</i></dt>
<dd>
Type of animal object used to populate pedigree</dd>
<dt>Returns:</dt>
<dd>
A reordered PyPedal pedigree.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.reorder-function' name='pyp_utils.reorder-function'><b>reorder(myped, filetag='_reordered_', io='no', missingparent=0, debug=0, max_rounds=100)</b></a> &rArr; list [<a href='#pyp_utils.reorder-function'>#</a>]</dt>
<dd>
<p>reorder() renumbers a pedigree such that parents precede their offspring in the
pedigree.  In order to minimize overhead as much as is reasonably possible,
a list of animal IDs that have already been seen is kept.  Whenever a parent
that is not in the seen list is encountered, the offspring of that parent is
moved to the end of the pedigree.  This should ensure that the pedigree is
properly sorted such that all parents precede their offspring.  myped is
reordered in place.  reorder() is VERY slow, but I am pretty sure that it works
correctly.</p>
<dl>
<dt><i>myped</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>filetag</i></dt>
<dd>
A descriptor prepended to output file names.</dd>
<dt><i>io</i></dt>
<dd>
Indicates whether or not to write the reordered pedigree to a file (yes|no).</dd>
<dt><i>missingparent</i></dt>
<dd>
Indicates the value used to indicate a missing parent.</dd>
<dt><i>debug</i></dt>
<dd>
Toggles debugging messages on and off.</dd>
<dt><i>max_rounds</i></dt>
<dd>
Maximum times to iterate through a pedigree trying to reorder it.</dd>
<dt>Returns:</dt>
<dd>
A reordered PyPedal pedigree.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.reverse_string-function' name='pyp_utils.reverse_string-function'><b>reverse_string(mystring)</b></a> &rArr; string [<a href='#pyp_utils.reverse_string-function'>#</a>]</dt>
<dd>
<p>reverse_string() reverses the input string and returns the reversed version.</p>
<dl>
<dt><i>mystring</i></dt>
<dd>
A non-empty Python string.</dd>
<dt>Returns:</dt>
<dd>
The input string with the order of its characters reversed.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.set_age-function' name='pyp_utils.set_age-function'><b>set_age(pedobj)</b></a> &rArr; integer [<a href='#pyp_utils.set_age-function'>#</a>]</dt>
<dd>
<p>set_age() Computes ages for all animals in a pedigree based on the global
BASE_DEMOGRAPHIC_YEAR defined in pyp_demog.py.  If the by is unknown, the
inferred generation is used.  If the inferred generation is unknown, the
age is set to -999.</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.set_ancestor_flag-function' name='pyp_utils.set_ancestor_flag-function'><b>set_ancestor_flag(pedobj)</b></a> &rArr; integer [<a href='#pyp_utils.set_ancestor_flag-function'>#</a>]</dt>
<dd>
<p>set_ancestor_flag() loops through a pedigree to build a dictionary of all of the parents
in the pedigree.  It then sets the ancestor flags for the parents.  set_ancestor_flag()
expects a reordered and renumbered pedigree as input!</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
A PyPedal NewPedigree object.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.set_generation-function' name='pyp_utils.set_generation-function'><b>set_generation(pedobj)</b></a> &rArr; integer [<a href='#pyp_utils.set_generation-function'>#</a>]</dt>
<dd>
<p>set_generation() Works through a pedigree to infer the generation to which an animal
belongs based on founders belonging to generation 1.  The igen assigned to an animal
as the larger of sire.igen+1 and dam.igen+1.  This routine assumes that myped is
reordered and renumbered.</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
A PyPedal NewPedigree object.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.set_species-function' name='pyp_utils.set_species-function'><b>set_species(pedobj, species='u')</b></a> &rArr; integer [<a href='#pyp_utils.set_species-function'>#</a>]</dt>
<dd>
<p>set_species() assigns a specie to every animal in the pedigree.</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>species</i></dt>
<dd>
A PyPedal string.</dd>
<dt>Returns:</dt>
<dd>
0 for failure and 1 for success.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.simple_histogram_dictionary-function' name='pyp_utils.simple_histogram_dictionary-function'><b>simple_histogram_dictionary(mydict, histchar='*', histstep=5)</b></a> &rArr; dictionary [<a href='#pyp_utils.simple_histogram_dictionary-function'>#</a>]</dt>
<dd>
<p>simple_histogram_dictionary() returns a dictionary containing a simple, text histogram.
The input dictionary is assumed to contain keys which are distinct levels and values
that are counts.</p>
<dl>
<dt><i>mydict</i></dt>
<dd>
A non-empty Python dictionary.</dd>
<dt><i>histchar</i></dt>
<dd>
The character used to draw the histogram (default is '*').</dd>
<dt><i>histstep</i></dt>
<dd>
Used to determine the number of bins (stars) in the diagram.</dd>
<dt>Returns:</dt>
<dd>
A dictionary containing the histogram by level or an empty dictionary (on failure).</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.sort_dict_by_keys-function' name='pyp_utils.sort_dict_by_keys-function'><b>sort_dict_by_keys(mydict)</b></a> &rArr; dictionary [<a href='#pyp_utils.sort_dict_by_keys-function'>#</a>]</dt>
<dd>
<p>sort_dict_by_keys() returns a dictionary where the values in the dictionary
in the order obtained by sorting the keys.  Taken from the routine sortedDictValues3
in the &quot;Python Cookbook&quot;, p. 39.</p>
<dl>
<dt><i>mydict</i></dt>
<dd>
A non-empty Python dictionary.</dd>
<dt>Returns:</dt>
<dd>
The input dictionary with keys sorted in ascending order or an empty dictionary (on failure).</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.sort_dict_by_values-function' name='pyp_utils.sort_dict_by_values-function'><b>sort_dict_by_values(first, second)</b></a> &rArr; list [<a href='#pyp_utils.sort_dict_by_values-function'>#</a>]</dt>
<dd>
<p>sort_dict_by_values() returns a dictionary where the keys in the dictionary
are sorted ascending value, first on value and then on key within value.  The
implementation was taken from John Hunter's contribution to a newsgroup thread:
http://groups-beta.google.com/group/comp.lang.python/browse_thread/thread/bbc259f8454e4d3f/cc686f4cd795feb4?q=python+%22sorted+dictionary%22=1=en#cc686f4cd795feb4
</p><dl>
<dt><i>mydict</i></dt>
<dd>
A non-empty Python dictionary.</dd>
<dt>Returns:</dt>
<dd>
A list of tuples sorted in ascending order.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.string_to_table_name-function' name='pyp_utils.string_to_table_name-function'><b>string_to_table_name(instring)</b></a> &rArr; string [<a href='#pyp_utils.string_to_table_name-function'>#</a>]</dt>
<dd>
<p>string_to_table_name() takes an arbitrary string and returns a string that
is safe to use as an SQLite table name.</p>
<dl>
<dt><i>instring</i></dt>
<dd>
A string that will be converted to an SQLite-safe table name.</dd>
<dt>Returns:</dt>
<dd>
A string that is safe to use as an SQLite table name.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.subpedigree-function' name='pyp_utils.subpedigree-function'><b>subpedigree(pedobj, anlist)</b></a> &rArr; object [<a href='#pyp_utils.subpedigree-function'>#</a>]</dt>
<dd>
<p>subpedigree() takes a NewPedigree object and list of animal
IDs and returns a NewPedigree object containing only the
animals in the animals list.</p>
<dl>
<dt><i>pedobj</i></dt>
<dd>
PyPedal pedigree object.</dd>
<dt><i>animals</i></dt>
<dd>
A list of animal IDs.</dd>
<dt>Returns:</dt>
<dd>
An instance of a NewPedigree object.</dd>
</dl><br />
</dd>
<dt><a id='pyp_utils.trim_pedigree_to_year-function' name='pyp_utils.trim_pedigree_to_year-function'><b>trim_pedigree_to_year(pedobj, year)</b></a> &rArr; list [<a href='#pyp_utils.trim_pedigree_to_year-function'>#</a>]</dt>
<dd>
<p>trim_pedigree_to_year() takes pedigrees and removes all individuals who were not born
in birthyear 'year'.</p>
<dl>
<dt><i>myped</i></dt>
<dd>
A PyPedal pedigree object.</dd>
<dt><i>year</i></dt>
<dd>
A birthyear.</dd>
<dt>Returns:</dt>
<dd>
A pedigree containing only animals born in the given birthyear or an ampty list (on failure).</dd>
</dl><br />
</dd>
</dl>
</body></html>
